<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>微信机器人启动器</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
        }

        #result {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            min-height: 50px;
        }

        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>

<body>
    <h1>微信机器人一键启动器</h1>
    <p style="color: crimson;">仅支持微信客户端v3.9.8.25、3.9.2.23</p>
    <p id="wechat-version" style="color:cadetblue;"></p>
    <button id="startButtonSidecar">启动<br>3.9.8.25</button>
    <button id="stopButtonSidecar">停止<br>3.9.8.25</button>
    <button id="startButtonFuntool">启动<br>3.9.2.23</button>
    <button id="stopButtonFuntool">停止<br>3.9.2.23</button>
    <button id="startButtonBot">启动Bot<br>wechaty</button>
    <button id="stopButtonBot">停止Bot<br>wechaty</button>
    <pre style="width: 90%; max-width: 90%; margin: auto; padding: 20px; text-align: left; border-radius: 1%;
    overflow-x: hidden; overflow-y: auto; text-overflow: ellipsis; white-space: pre-wrap;
    border: 1px solid #ccc; height: 18em;
    font-family: monospace; background-color: black; color: white;" name="log" id="log">
程序启动，载入中...
</pre>


    <script>
        const { ipcRenderer } = require('electron');

        document.getElementById('startButtonSidecar').addEventListener('click', () => {
            ipcRenderer.send('start-sidecar');
        });

        document.getElementById('stopButtonSidecar').addEventListener('click', () => {
            ipcRenderer.send('stop-sidecar');
        });

        document.getElementById('startButtonFuntool').addEventListener('click', () => {
            ipcRenderer.send('start-funtool');
        });

        document.getElementById('stopButtonFuntool').addEventListener('click', () => {
            ipcRenderer.send('stop-funtool');
        });

        document.getElementById('stopButtonBot').addEventListener('click', () => {
            ipcRenderer.send('stop-bot');
        });

        document.getElementById('stopButtonBot').addEventListener('click', () => {
            ipcRenderer.send('stop-bot');
        });

        ipcRenderer.on('action-result', (event, result) => {
            const resultDiv = document.getElementById('log');
            resultDiv.innerHTML = result; // 显示执行结果
        });

        ipcRenderer.on('wechat-check-result', (event, result) => {
            const resultDiv = document.getElementById('wechat-version');
            resultDiv.textContent = result; // 显示 WeChat 检查结果
            // 获取按钮元素
            var startButtonFuntool = document.querySelector('#startButtonFuntool');
            var stopButtonFuntool = document.querySelector('#stopButtonFuntool');
            var startButtonSidecar = document.querySelector('#startButtonSidecar');
            var stopButtonSidecar = document.querySelector('#stopButtonSidecar');
            // 检查result的值
            if (result === '本机安装的版本号: 3.9.2.1000') {
                // 如果result等于'3.9.2.1000'，则禁用按钮
                startButtonFuntool.disabled = false;
                stopButtonFuntool.disabled = false;
                startButtonSidecar.disabled = true;
                stopButtonSidecar.disabled = true;
            } else if (result === '本机安装的版本号: 3.9.8.1000') {
                // 否则，启用按钮
                startButtonFuntool.disabled = true;
                stopButtonFuntool.disabled = true;
                startButtonSidecar.disabled = false;
                stopButtonSidecar.disabled = false;
            } else {
                // 否则，禁用按钮
                startButtonFuntool.disabled = true;
                stopButtonFuntool.disabled = true;
                startButtonSidecar.disabled = true;
                stopButtonSidecar.disabled = true;
            }
        });

    </script>
</body>

</html>